{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\James Pan\\\\Desktop\\\\demo\\\\groundstationweb\\\\src\\\\components\\\\GroundStation\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport { Tab } from \"semantic-ui-react\";\nimport \"../MapArea/css/resize.css\";\nimport MapArea from \"../MapArea\";\nimport DataArea from \"../DataArea\";\nimport DropArea from \"../DropArea\";\nimport { predictPayload, predictCDA } from \"../../helpers/predictions\";\nimport { predictLoc } from \"../../helpers/location\";\nimport { getDirection } from \"../../helpers/direction\";\n\nclass GroundStation extends Component {\n  constructor(props) {}\n\n  render() {\n    const currentData = this.state.currentData;\n    return React.createElement(Tab.Pane, {\n      style: {\n        paddingLeft: 0,\n        paddingBottom: \"1em\",\n        border: \"none\",\n        height: \"100%\",\n        boxSizing: \"content-box\",\n        paddingRight: 0,\n        maxWidth: \"100%\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        display: \"flex\",\n        height: \"calc(100% - 2em)\",\n        overflow: \"hidden\",\n        overflowX: \"auto\",\n        paddingBottom: \"1em\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, React.createElement(MapArea, {\n      currentData: currentData,\n      planePositionHistory: this.planePositionHistory,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }), React.createElement(DataArea, {\n      saveLog: this.saveDataLog,\n      clearLog: this.clearDataLog,\n      receiveData: this.receiveData,\n      currentData: currentData,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(DropArea, {\n      currentData: currentData,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default GroundStation;","map":{"version":3,"sources":["C:/Users/James Pan/Desktop/demo/groundstationweb/src/components/GroundStation/index.jsx"],"names":["React","Component","Tab","MapArea","DataArea","DropArea","predictPayload","predictCDA","predictLoc","getDirection","GroundStation","constructor","props","render","currentData","state","paddingLeft","paddingBottom","border","height","boxSizing","paddingRight","maxWidth","display","overflow","overflowX","planePositionHistory","saveDataLog","clearDataLog","receiveData"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,GAAT,QAAoB,mBAApB;AACA,OAAO,2BAAP;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,OAAOC,QAAP,MAAqB,aAArB;AACA,OAAOC,QAAP,MAAqB,aAArB;AAEA,SAASC,cAAT,EAAyBC,UAAzB,QAA2C,2BAA3C;AACA,SAASC,UAAT,QAA2B,wBAA3B;AACA,SAASC,YAAT,QAA6B,yBAA7B;;AAGA,MAAMC,aAAN,SAA4BT,SAA5B,CAAsC;AACpCU,EAAAA,WAAW,CAACC,KAAD,EAAO,CAEjB;;AAoEDC,EAAAA,MAAM,GAAG;AAAA,UACCC,WADD,GACiB,KAAKC,KADtB,CACCD,WADD;AAEP,WACE,oBAAC,GAAD,CAAK,IAAL;AACE,MAAA,KAAK,EAAE;AACLE,QAAAA,WAAW,EAAE,CADR;AAELC,QAAAA,aAAa,EAAE,KAFV;AAGLC,QAAAA,MAAM,EAAE,MAHH;AAILC,QAAAA,MAAM,EAAE,MAJH;AAKLC,QAAAA,SAAS,EAAE,aALN;AAMLC,QAAAA,YAAY,EAAE,CANT;AAOLC,QAAAA,QAAQ,EAAE;AAPL,OADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAWE;AAAK,MAAA,KAAK,EAAE;AAAEC,QAAAA,OAAO,EAAE,MAAX;AAAmBJ,QAAAA,MAAM,EAAE,kBAA3B;AAA+CK,QAAAA,QAAQ,EAAE,QAAzD;AAAmEC,QAAAA,SAAS,EAAE,MAA9E;AAAsFR,QAAAA,aAAa,EAAE;AAArG,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,OAAD;AAAS,MAAA,WAAW,EAAEH,WAAtB;AAAmC,MAAA,oBAAoB,EAAE,KAAKY,oBAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAEE,oBAAC,QAAD;AAAU,MAAA,OAAO,EAAE,KAAKC,WAAxB;AAAqC,MAAA,QAAQ,EAAE,KAAKC,YAApD;AAAkE,MAAA,WAAW,EAAE,KAAKC,WAApF;AAAiG,MAAA,WAAW,EAAEf,WAA9G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EAGE,oBAAC,QAAD;AAAU,MAAA,WAAW,EAAEA,WAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHF,CAXF,CADF;AAmBD;;AA5FmC;;AA+FtC,eAAeJ,aAAf","sourcesContent":["import React, { Component } from 'react';\nimport { Tab } from \"semantic-ui-react\";\nimport \"../MapArea/css/resize.css\";\nimport MapArea from \"../MapArea\";\nimport DataArea from \"../DataArea\";\nimport DropArea from \"../DropArea\";\n\nimport { predictPayload, predictCDA } from \"../../helpers/predictions\";\nimport { predictLoc } from \"../../helpers/location\";\nimport { getDirection } from \"../../helpers/direction\";\n\n\nclass GroundStation extends Component {\n  constructor(props){\n    \n  }\n  dataLog = [];\n\n  planePositionHistory = [];\n\n  state = {\n    currentData: {},\n  };\n\n  lastPacketTime = 0;\n\n  receiveData = (rawData) => {\n    const { currentData } = this.state;\n    const data = JSON.parse(rawData);\n    const time = +Date.now();\n    const timeElapsed = time - this.lastPacketTime;\n    data.timeElapsed = timeElapsed;\n    this.lastPacketTime = time;\n    if (data.flightData) {\n      data.flightData.timeRecieved = (time / 1000) || 0;\n\n      data.flightData.payloadPredictionDistance = predictPayload(data.flightData.altitude, data.flightData.velocity, data.flightData.headwind);\n      data.flightData.CDAPredictionDistance = predictCDA(data.flightData.altitude, data.flightData.velocity, data.flightData.headwind);\n\n      data.flightData.direction = getDirection(currentData.flightData, data.flightData);\n\n      data.flightData.payloadLatLong = predictLoc(data.flightData, data.flightData.payloadPredictionDistance);\n      data.flightData.cdaLatLong = predictLoc(data.flightData, data.flightData.CDAPredictionDistance);\n\n      this.planePositionHistory.push([data.flightData.latitude, data.flightData.longitude]);\n      this.dataLog.push(data.flightData);\n\n      this.setState({ currentData: data });\n    }\n  };\n\n\n  clearDataLog = () => {\n    this.dataLog = [];\n  };\n\n  download = (filename, text) => {\n    const pom = document.createElement('a');\n    pom.setAttribute('href', `data:text/plain;charset=utf-8,${encodeURIComponent(text)}`);\n    pom.setAttribute('download', filename);\n\n    if (document.createEvent) {\n      const event = document.createEvent('MouseEvents');\n      event.initEvent('click', true, true);\n      pom.dispatchEvent(event);\n    } else {\n      pom.click();\n    }\n  };\n\n  saveDataLog = () => {\n    console.info(\"Saving\", this.dataLog.length, \"records\");\n    let csv = \"TimeSent, TimeRecieved, Latitude, Longitude, GPS Altitude (ft), Velocity (m/s), GPS Accuracy,\"\n      + \"Payload Prediction (ft), Payload Target Lat, Payload Target Long, CDA Prediction (ft), CDA Target Lat, CDA Target Long\";\n    this.dataLog.forEach((d) => {\n      csv = `${csv}\\n${d.timeSent}, ${d.timeRecieved}, ${d.latitude}, ${d.longitude}, ${d.altitude}, ${d.velocity}, ${d.accuracy}, \\\n            ${d.payloadPredictionDistance},${d.payloadLatLong[0]}, ${d.payloadLatLong[1]},${d.CDAPredictionDistance},${d.cdaLatLong[0]}, ${d.cdaLatLong[1]}`;\n    });\n\n    this.download(`Flight Log ${new Date().toISOString()}.csv`, csv);\n  };\n\n\n  render() {\n    const { currentData } = this.state;\n    return (\n      <Tab.Pane\n        style={{\n          paddingLeft: 0,\n          paddingBottom: \"1em\",\n          border: \"none\",\n          height: \"100%\",\n          boxSizing: \"content-box\",\n          paddingRight: 0,\n          maxWidth: \"100%\",\n        }}\n      >\n        <div style={{ display: \"flex\", height: \"calc(100% - 2em)\", overflow: \"hidden\", overflowX: \"auto\", paddingBottom: \"1em\" }}>\n          <MapArea currentData={currentData} planePositionHistory={this.planePositionHistory} />\n          <DataArea saveLog={this.saveDataLog} clearLog={this.clearDataLog} receiveData={this.receiveData} currentData={currentData} />\n          <DropArea currentData={currentData} />\n        </div>\n      </Tab.Pane>\n    );\n  }\n}\n\nexport default GroundStation;\n"]},"metadata":{},"sourceType":"module"}